const ae="modulepreload",se=function(e){return"/"+e},U={},ce=function(t,n,i){let o=Promise.resolve();if(n&&n.length>0){let s=function(u){return Promise.all(u.map(g=>Promise.resolve(g).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),c=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));o=s(n.map(u=>{if(u=se(u),u in U)return;U[u]=!0;const g=u.endsWith(".css"),y=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${y}`))return;const h=document.createElement("link");if(h.rel=g?"stylesheet":ae,g||(h.as="script"),h.crossOrigin="",h.href=u,c&&h.setAttribute("nonce",c),document.head.appendChild(h),g)return new Promise((k,I)=>{h.addEventListener("load",k),h.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(s){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=s,window.dispatchEvent(r),!r.defaultPrevented)throw s}return o.then(s=>{for(const r of s||[])r.status==="rejected"&&a(r.reason);return t().catch(a)})},ue={quoteTransitionLongFrameMs:120};let C=null;function le(e){C=e}const fe=()=>typeof window<"u";let f={enabled:!1,maxRetries:3,retryBaseDelayMs:400,circuitBreakerThreshold:6,circuitBreakerCooldownMs:6e4,batchSizeLimit:50,batchBytesLimit:3e4};function de(e){f={...f,...e}}let b=0,w=!1,_=null;function q(e,t){try{C==null||C({category:"lifecycle",action:e,priority:"high",...t?{metadata:t}:{}})}catch{}}function he(){const e=w;b=0,w=!1,_=null,e&&q("breaker_closed")}function B(){b+=1;const e=f.circuitBreakerThreshold||6;!w&&b>=e&&(w=!0,_=Date.now(),q("breaker_open",{consecutiveFailures:b}))}function we(){return w?_&&Date.now()-_>(f.circuitBreakerCooldownMs||6e4)?(q("breaker_half_open"),!0):!1:!0}const p=[];let S=!1,F=null;function Z(){return!!(f.enabled&&f.endpoint)}function ye(e){p.push(e),$()}function $(){fe()&&F==null&&(F=window.setTimeout(()=>{F=null,L()},3e3))}function L(e=!1){if(Z()&&!(!e&&p.length===0)&&we()&&!S){S=!0;try{const t=[];let n=0;const i=f.batchBytesLimit||3e4,o=f.batchSizeLimit||50;for(;p.length&&t.length<o;){const a=p[0],s=JSON.stringify(a).length+1;if(n+s>i&&t.length>0)break;p.shift(),t.push(a),n+=s}if(t.length===0){S=!1;return}R(t,0).finally(()=>{S=!1,p.length&&$()})}catch{S=!1}}}async function R(e,t){const n=f.endpoint,i=f.maxRetries??3,o=JSON.stringify({events:e}),a={"Content-Type":"application/json"};try{const s=await fetch(n,{method:"POST",headers:a,body:o,keepalive:f.useBeacon===!0});if(s.ok)he();else{if(s.status>=400&&s.status<500){B();return}if(t<i){const r=(f.retryBaseDelayMs||400)*Math.pow(2,t);return await new Promise(c=>setTimeout(c,r)),R(e,t+1)}else B(),w||p.unshift(...e)}}catch{if(t<i){const s=(f.retryBaseDelayMs||400)*Math.pow(2,t);return await new Promise(r=>setTimeout(r,s)),R(e,t+1)}else B(),w||p.unshift(...e)}}function ge(){return{enabled:f.enabled,endpoint:f.endpoint,queueLength:p.length,breaker:{open:w,consecutiveFailures:b,openedAt:_}}}const M={_getBreaker:()=>({consecutiveFailures:b,breakerOpen:w,breakerOpenedAt:_}),_resetBreaker:()=>{b=0,w=!1,_=null},_forceHalfOpen:()=>{w&&(_=Date.now()-(f.circuitBreakerCooldownMs||6e4)-10)},_forceFlush:()=>{try{L(!0)}catch{}}};let Q=!1;function G(){typeof window>"u"||Q||(Q=!0,window.addEventListener("error",e=>{l({category:"error",action:"exception",priority:"high",metadata:{message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,stack:e.error&&e.error.stack||void 0,name:e.error&&e.error.name||void 0}})}),window.addEventListener("unhandledrejection",e=>{const t=e.reason;let n="unknown",i;t&&(typeof t=="string"?n=t:t instanceof Error?(n=t.message,i=t.stack):typeof t.message=="string"&&(n=String(t.message))),l({category:"error",action:"unhandled_rejection",priority:"high",metadata:{reason:n,stack:i,name:t instanceof Error?t.name:void 0}})}))}const He=Object.freeze(Object.defineProperty({__proto__:null,installErrorHooks:G},Symbol.toStringTag,{value:"Module"})),pe=new Set(["userEmail","userId"]);function j(e,t=0,n=new WeakSet,i){if(!e)return e;const o=i||e;if(t>4)return{tooDeep:!0};const a={},s=/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/ig;for(const[r,c]of Object.entries(e)){if(c==null){a[r]=c;continue}if(typeof c=="string"&&!pe.has(r)){a[r]=c.replace(s,"[redacted-email]");continue}if(typeof c=="object"){if(c===o){a[r]="[circular]";continue}if(n.has(c)){a[r]="[circular]";continue}n.add(c),Array.isArray(c)?a[r]=c.map(u=>typeof u=="string"?u.replace(s,"[redacted-email]"):u&&typeof u=="object"?j(u,t+1,n,o)||null:u):a[r]=j(c,t+1,n,o)||c;continue}a[r]=c}return a}const _e="haic:analyticsConsent",D="__SESSION_ID__",J="haic:lastFlushTs",X="__ANALYTICS_USER__",ee={heartbeat:.5},me={_resetBreaker:()=>{try{M._resetBreaker()}catch{}},_forceHalfOpen:()=>{try{M._forceHalfOpen()}catch{}},_forceFlush:()=>{try{L(!0)}catch{}},_getBreaker:()=>{try{return M._getBreaker()}catch{return{}}},_drain:async(e=500)=>{await new Promise(n=>setTimeout(n,5));const t=Date.now();for(;Date.now()-t<e;){await new Promise(n=>setTimeout(n,10));break}}};function ve(e){}function H(e){try{localStorage.setItem(J,String(e))}catch{}}function te(){try{const e=localStorage.getItem(J);if(!e)return null;const t=Number(e);return Number.isFinite(t)?t:null}catch{return null}}function d(){return typeof window<"u"}function ne(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function v(){return d()?window.__ANALYTICS_CONSENT__===!0:!1}function be(e){if(d()){window.__ANALYTICS_CONSENT__=e;try{localStorage.setItem(_e,e?"granted":"denied")}catch{}}}function re(){if(d())return window[D]||(window[D]=ne()),window[D]}const Y=200,T=[];function ke(e,t){if(!d())return;const n=window;n[X]={userId:e,traits:t}}function Ee(){return d()?window[X]:void 0}function Se(e){const t=ee[e];return t==null?!0:Math.random()<t}function Te(e){return T.includes(e)?!1:(T.push(e),T.length>Y&&T.splice(0,T.length-Y),!0)}const E=[],m=[];let x=null,O=null;function xe(e,t){switch(e){case"interaction":return["click","cta","toggle","sw_auto_refresh","sw_background_notice","sw_update_decision","sw_hard_bust_complete","question_submit"].includes(t);case"config":return["drift"].includes(t);case"navigation":return["page_view","hash_change","section_view"].includes(t);case"perf":return["hero_paint","fid","cls_total","quote_transition","perf_metric"].includes(t);case"engagement":return["focus","visibility_change"].includes(t);case"error":return["exception","unhandled_rejection"].includes(t);case"lifecycle":return["session_start","consent_granted","consent_denied","breaker_open","breaker_half_open","breaker_closed"].includes(t);case"heartbeat":return["interval_ping"].includes(t);case"intro":return["intro_impression","intro_stage_view","intro_completed","intro_safety_fallback"].includes(t);default:return!1}}function P(e){var y,h,k,I;const{category:t="interaction",action:n,label:i,value:o,metadata:a}=e;if(!Se(t)||!xe(t,n))return;const s=re(),r=ne();if(!Te(r))return;const c=Ee(),u=j(a),g={event:"custom_event",eventCategory:t,eventAction:n,...i?{eventLabel:i}:{},...typeof o=="number"?{eventValue:o}:{},sessionId:s,eventId:r,...c?{userId:c.userId,userTraits:c.traits}:{},timestamp:Date.now(),...u};try{Array.isArray(window.dataLayer)&&window.dataLayer.push(g)}catch{}try{(h=(y=window.analytics)==null?void 0:y.track)==null||h.call(y,n,{category:t,label:i,value:o,...u,sessionId:s})}catch{}try{(I=(k=window.posthog)==null?void 0:k.capture)==null||I.call(k,n,{category:t,label:i,value:o,...u,sessionId:s})}catch{}Z()&&ye(g)}function ie(){if(d()&&!x&&(x=window.setTimeout(()=>{z()},4e3),"requestIdleCallback"in window&&O==null)){const e=window.requestIdleCallback;e&&(O=e(()=>z()))}}function z(){if(v()){for(O&&(O=null),x&&(window.clearTimeout(x),x=null);m.length;){const e=m.shift();e&&P(e)}H(Date.now())}}function oe(){if(v()){for(;E.length;){const e=E.shift();e&&(e.priority==="low"?m.push(e):P(e))}m.length&&ie(),H(Date.now()),L(!0)}}function l(e){if(d()){if(!v()){E.push(e);return}if(e.priority==="low"){m.push(e),ie();return}P(e)}}function Le(e){l({category:"navigation",action:"hash_change",label:e||"empty"})}function Ie(){if(!d())return;if(!v()){E.push({category:"perf",action:"hero_paint",value:Math.round(performance.now())});return}const e=performance.now();l({category:"perf",action:"hero_paint",value:Math.round(e)})}function Ae(e,t,n,i){if(!d())return;const o={metric:e,...i?{phase:i}:{},...n||{}};if(!v()){E.push({category:"perf",action:"perf_metric",value:Math.round(t),metadata:o,priority:"high"});return}l({category:"perf",action:"perf_metric",value:Math.round(t),metadata:o})}function Ce(){re()}let V=null;function Oe(e=300*1e3){if(!d()||V)return;const t=()=>{document.visibilityState==="visible"&&l({category:"heartbeat",action:"interval_ping",priority:"low",metadata:{intervalMs:e}})};V=window.setInterval(t,e),t()}function Pe(){d()&&(window.addEventListener("visibilitychange",()=>{l({category:"engagement",action:"visibility_change",priority:"low",metadata:{state:document.visibilityState}})}),window.addEventListener("focus",()=>{l({category:"engagement",action:"focus",priority:"low"})}))}function Be(e=["mission","vision","voices"]){if(!d()||!("IntersectionObserver"in window))return;const t=new Set,n=new IntersectionObserver(i=>{i.forEach(o=>{if(o.isIntersecting){const a=o.target.getAttribute("id");a&&!t.has(a)&&(t.add(a),l({category:"navigation",action:"section_view",label:a,priority:"low"}))}})},{threshold:.35});e.forEach(i=>{const o=document.getElementById(i);o&&n.observe(o)})}function Fe(){l({category:"lifecycle",action:"consent_granted"}),oe();try{ce(()=>import("./appInsights-BLH12nN8.js"),[]).then(e=>e.enableAppInsightsTelemetry()).catch(()=>{})}catch{}}function Me(){l({category:"lifecycle",action:"consent_denied"})}let K=!1;function De(){if(!d()||K)return;K=!0;const e=()=>{if(v()){for(;m.length;){const t=m.shift();t&&P(t)}H(Date.now()),L(!0)}};window.addEventListener("pagehide",e),window.addEventListener("beforeunload",e)}function Ne(){const e=ge();return{consent:v(),lowPriorityQueue:m.length,preConsentQueue:E.length,backendTransport:e,lastFlushTs:te(),sampling:ee}}let N=!1;function Re(){if(!d()||N)return;const e=()=>{if(N)return;N=!0;const t=performance.now();l({category:"perf",action:"fid",value:Math.round(t)}),window.removeEventListener("pointerdown",e,!0),window.removeEventListener("keydown",e,!0)};window.addEventListener("pointerdown",e,!0),window.addEventListener("keydown",e,!0)}let A=0,W=!1;function je(){if(!(!d()||W||!("PerformanceObserver"in window))){W=!0;try{new PerformanceObserver(t=>{for(const n of t.getEntries()){const i=n;typeof i.value=="number"&&!i.hadRecentInput&&(A+=i.value)}}).observe({type:"layout-shift",buffered:!0}),window.addEventListener("pagehide",()=>{A>0&&l({category:"perf",action:"cls_total",value:Math.round(A*1e3),metadata:{raw:A}})})}catch{}}}function qe(e,t=ue.quoteTransitionLongFrameMs){e>t&&l({category:"perf",action:"quote_transition",value:Math.round(e),metadata:{threshold:t}})}le(({category:e,action:t,metadata:n})=>{l(n?{category:e,action:t,priority:"high",metadata:n}:{category:e,action:t,priority:"high"})});const Ue=Object.freeze(Object.defineProperty({__proto__:null,__test:me,configureAnalyticsTransport:de,flushPreConsentQueue:oe,getAnalyticsDebugInfo:Ne,getLastFlushTs:te,hasAnalyticsConsent:v,initAnalyticsSession:Ce,initFirstInputDelayCapture:Re,initLayoutShiftObserver:je,initSectionObserver:Be,initVisibilityListeners:Pe,installErrorHooks:G,onConsentDenied:Me,onConsentGranted:Fe,registerUnloadFlush:De,setAnalyticsConsent:be,setAnalyticsQuietMode:ve,setUserContext:ke,startHeartbeat:Oe,trackEvent:l,trackHashNavigation:Le,trackHeroPaint:Ie,trackPerfMetric:Ae,trackQuoteTransition:qe},Symbol.toStringTag,{value:"Module"}));export{ce as _,qe as a,ke as b,Me as c,M as d,de as e,L as f,oe as g,v as h,Ce as i,Ne as j,Le as k,Pe as l,Be as m,Oe as n,Fe as o,Ie as p,Ae as q,Re as r,be as s,l as t,je as u,He as v,Ue as w};
